<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: index.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: index.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * 通用的一些工具方法
 * @module
 * */

/**
 * 获取cookie
 * @param {String} objName 存储coolie中数据的key
 * @returns {String}
 */
export function getCookie(objName) {
    let arrStr = document.cookie.split('; ');
    for (let i = 0; i &lt; arrStr.length; i++) {
        let temp = arrStr[i].split('=');
        if (temp[0] === objName) return unescape(temp[1]);
    }
    return '';
}

/**
 * 获取浏览器
 * @returns {number}
 */
export function getScrollBarWidth() {
    let scrollDiv = document.createElement('div');
    scrollDiv.style.position = 'absolute';
    scrollDiv.style.top = '-9999px';
    scrollDiv.style.width = '50px';
    scrollDiv.style.height = '50px';
    scrollDiv.style.overflow = 'scroll';
    document.body.appendChild(scrollDiv);
    let scrollBarWidth = scrollDiv.offsetWidth - scrollDiv.clientWidth;
    window.document.body.removeChild(scrollDiv);
    return scrollBarWidth;
}

/**
 * 获得一个指定范围内的随机数
 * @param {number} min 最范围
 * @param {number} max 最大范围
 * @returns {number}
 */
export function getRandomNum(min, max) {
    const range = max - min;
    const rand = Math.random();
    return (min + Math.round(rand * range));
}

/**
 * 为一个dom元素移除class
 * @param {string} selector document.querySelectory 要到的选择器
 * @param {string} className 要移除的class
 */
export function removeClass(selector, className) {
    let dom = selector;
    if (typeof selector === 'string') {
        dom = document.querySelector(selector);
    }
    if (!dom) return;
    let domClass = dom.className;
    if (domClass) {
        domClass = domClass.split(' ');
        if (!domClass || !domClass.length) return;
        dom.className = domClass.filter(c => c !== className).join(' ');
    }
}

/**
 * 为一个dom元素添加class
 * @param {string} selector document.querySelectory 要到的选择器
 * @param {string} className 要添加的class
 */
export function addClass(selector, className) {
    let dom = selector;
    if (typeof selector === 'string') {
        dom = document.querySelector(selector);
    }
    if (!dom) return;
    let domClass = dom.className;
    if (domClass) {
        domClass = domClass.split(' ');
        if (!domClass || !domClass.length || domClass.indexOf(className) > -1) return;
        domClass.push(className);
        dom.className = domClass.join(' ');
    } else {
        dom.className = className;
    }
}

/**
 * 拼接get请求所需url
 * @param {string} url
 * @param {object} params 请求参数
 * @returns {string} 拼接后的url
 */
export function mosaicUrl(url, params) {
    if (!params) return url;
    const queryString = [];
    Object.keys(params).forEach(key => {
        let value = params[key];
        if (value !== undefined &amp;&amp; value !== null) {
            queryString.push(`${key}=${value}`);
        }
    });
    const qStr = queryString.join('&amp;');
    if (url.indexOf('?') &lt; 0) {
        url += `?${qStr}`;
    } else if (url.endsWith('&amp;')) {
        url += qStr;
    } else if (url.endsWith('?')) {
        url += `${qStr}`;
    } else {
        url += `&amp;${qStr}`;
    }
    return url;
}

/**
 * 根据keyPath查找一个object中的数据
 * @param obj 需要查找的对象
 * @param {string} keyPath 类似： a.b.c
 * @returns {*} 查找到的数据
 */
function findObjByKeyPath(obj, keyPath) {
    const keys = keyPath.split('.');
    let targetObj = obj;
    keys.forEach(k => {
        targetObj = targetObj[k];
    });
    return targetObj;
}

/**
 * 从数组中删除一个元素，此方法具有副作用，修改了原数组
 * @param {array} arr 需要操作的数组
 * @param {*} item 要删除的元素，注意：内部是用'==='比对的
 */
function arrayRemove(arr, item) {
    let itemIndex = -1;
    for (let i = 0; i &lt; arr.length; i++) {
        if (arr[i] === item) {
            itemIndex = i;
            break;
        }
    }
    if (itemIndex > -1) {
        arr.splice(itemIndex, 1);
    }
}
/**
 * 根据指定keyPath 添加元素，此方法具有副作用，修改了传入的obj
 * @param obj 要操作的数据
 * @param {string} keyPath 类似于：a.b.c，就会把value赋值给c
 * @param {*} value 要设置的数据
 * @throws Will throw error if keyPath dose not point to an object
 */
export function objSetValue(obj, keyPath, value) {
    const pointLastIndex = keyPath.lastIndexOf('.');
    if (pointLastIndex &lt; 0) {
        if (typeof obj !== 'object') {
            throw new Error('keyPath dose not point to an boject!');
        }
        obj[keyPath] = value;
        return;
    }
    const key = keyPath.substr(pointLastIndex + 1, keyPath.length);
    keyPath = keyPath.substr(0, pointLastIndex);
    let targetObj = findObjByKeyPath(obj, keyPath);
    if (typeof targetObj !== 'object') {
        throw new Error('keyPath dose not point to an boject!');
    }
    targetObj[key] = value;
}

/**
 * 根据keyPath定位到指定元素，并将其删除，此方法具有副作用，修改了传入的obj
 * @param obj 要操作的数据
 * @param {string} keyPath keyPath 类似于：a.b.c，会把c删除
 * @throws Will throw error if keyPath dose not point to an object
 */
export function objRemove(obj, keyPath) {
    const pointLastIndex = keyPath.lastIndexOf('.');
    if (pointLastIndex &lt; 0) {
        if (typeof obj !== 'object') {
            throw new Error('keyPath dose not point to an object!');
        }
        delete obj[keyPath];
        return;
    }
    const key = keyPath.substr(pointLastIndex + 1, keyPath.length);
    keyPath = keyPath.substr(0, pointLastIndex);
    let targetObj = findObjByKeyPath(obj, keyPath);
    if (typeof targetObj !== 'object') {
        throw new Error('keyPath dose not point to an object!');
    }
    delete targetObj[key];
}
/**
 * 根据keyPath定位到指定数组，并添加元素，此方法具有副作用，修改了传入的obj
 * @param obj 要操作的数据
 * @param keyPath 类似于：a.b.c，通过keyPath，定位到obj中某个数组
 * @param value 需要append的元素
 * @throws Will throw error if keyPath dose not point to an array
 */
export function arrAppendValue(obj, keyPath, value) {
    let targetObj = findObjByKeyPath(obj, keyPath);
    if (!Array.isArray(targetObj)) {
        throw new Error('keyPath dose not point to an array!');
    }
    if (Array.isArray(value) &amp;&amp; value.length) {
        value.forEach(v => targetObj.push(v));
    } else {
        targetObj.push(value);
    }
}
/**
 * 根据keyPath定位到指定数组，删除一个元素，此方法具有副作用，修改了传入的obj
 * @param obj 要操作的数据
 * @param keyPath 类似于：a.b.c，通过keyPath，定位到obj中某个数组
 * @param value 需要删除的数组元素
 * @throws Will throw error if keyPath dose not point to an array
 */
export function arrRemove(obj, keyPath, value) {
    let targetObj = findObjByKeyPath(obj, keyPath);
    if (!Array.isArray(targetObj)) {
        throw new Error('keyPath dose not point to an array!');
    }
    arrayRemove(targetObj, value);
}

/**
 * 根据keyPath定位到指定数组，删除所有跟value相同的元素，此方法具有副作用，修改了传入的obj
 * @param obj 要操作的数据
 * @param keyPath 类似于：a.b.c，通过keyPath，定位到obj中某个数组
 * @param value 移除的数组元素
 * @throws Will throw error if keyPath dose not point to an array
 */
export function arrRemoveAll(obj, keyPath, value) {
    let targetObj = findObjByKeyPath(obj, keyPath);
    if (!Array.isArray(targetObj)) {
        throw new Error('keyPath dose not point to an array!');
    }
    while (targetObj.indexOf(value) > -1) {
        arrayRemove(targetObj, value);
    }
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-utils_async-tree-utils.html">utils/async-tree-utils</a></li><li><a href="module-utils_index.html">utils/index</a></li><li><a href="module-utils_pubsubmsg.html">utils/pubsubmsg</a></li></ul><h3>Global</h3><ul><li><a href="global.html#convertToTree">convertToTree</a></li><li><a href="global.html#endFetchingComponent">endFetchingComponent</a></li><li><a href="global.html#getNodeByKey">getNodeByKey</a></li><li><a href="global.html#getNodeByKeyValue">getNodeByKeyValue</a></li><li><a href="global.html#getTopNodeByNode">getTopNodeByNode</a></li><li><a href="global.html#hasParent">hasParent</a></li><li><a href="global.html#init">init</a></li><li><a href="global.html#shouldComponentMount">shouldComponentMount</a></li><li><a href="global.html#singleGet">singleGet</a></li><li><a href="global.html#startFetchingComponent">startFetchingComponent</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.3</a> on Tue Apr 18 2017 18:01:15 GMT+0800 (CST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
